async function htmlWidget(t,e,a){const r={colour:{add:async(t,e,a)=>{const r=e.split("-"),n=2==r.length?"Color.dynamic("+await z(r[0])+","+await z(r[1])+")":await z(r[0]);k+=`\n${a}.${t.toLowerCase().replace(/[^a-zA-Z0-9]+(.)/g,(t,e)=>e.toUpperCase())} = ${n}`},validate:()=>{}},posInt:{add:(t,e,a)=>{k+="refresh-after-date"==t?`\nlet date = new Date()\ndate.setMinutes(date.getMinutes() + ${/\d+/.exec(e)})\nwidget.refreshAfterDate = date`:`\n${a}.${t.toLowerCase().replace(/[^a-zA-Z0-9]+(.)/g,(t,e)=>e.toUpperCase())} = ${/\d+/.exec(e)}`},validate:(t,e,a)=>{if(!/^\s*\d+\s*$/.test(a))throw new Error(`${t} ${e?"Attribute":"Property"} Must Be A Positive Integer: ${a}`)}},decimal:{add:(t,e,a)=>{(e=/\d*(?:\.\d*)?%?/.exec(e)[0]).endsWith("%")&&(e=Number(e.replace("%","")),e/=100),k+=`\n${a}.${t.toLowerCase().replace(/[^a-zA-Z0-9]+(.)/g,(t,e)=>e.toUpperCase())} = ${e}`},validate:(t,e,a)=>{let r=/^\s*(\d*(?:\.\d*)?)%?\s*$/;if(!a.match(r)||a.match(r)&&["","."].includes(a.match(r)[1]))throw new Error(`${t} ${e?"Attribute":"Property"} Must Be A Positive Integer Or Float With An Optional "%" At The End: ${a}`)}},gradient:{add:async(t,e,a)=>{v++;let r,n=e;n=n.split(/,(?![^(]*\))(?![^"']*["'](?:[^"']*["'][^"']*["'])*[^"']*$)/).map(t=>t.trim());const o={"to left":90,"to right":270,"to top":180,"to bottom":0,"to top left":135,"to top right":225,"to bottom left":45,"to bottom right":315,"to left top":135,"to right top":225,"to left bottom":45,"to right bottom":315};r=Object.keys(o).includes(n[0])?o[n.shift()]:/\d+\s*deg/.test(n[0])?Number(n.shift().match(/(\d+)\s*deg/)[1]):0;let i=[];for(let t of n)2==(t=(t=t.replace(/\d*(\.\d+)?%?$/,"")).split("-")).length?i.push(Color.dynamic(await z(t[0]),await z(t[1]))):i.push(await z(t[0]));let l=n.map(t=>/\d*(\.\d+)?%?$/.test(t)?t.match(/\d*(\.\d+)?%?$/)[0]:null).map(t=>(t&&t.endsWith("%")&&(t=Number(t.replace("%",""))/100),!isNaN(t)&&!isNaN(parseFloat(t))||"number"==typeof t?Number(t):null));l[0]||(l[0]=0),l[l.length-1]||(l[l.length-1]=1);for(let t=0;t<l.length;t++){if(l[t]){let e=0,a=t;for(;null===l[a];)e++,a++;let r=(l[a]-l[t-1])/(e+1);for(let a=0;a<e;a++)l[a+t]=r*(a+1)+l[t-1]}}k+=`\nlet gradient${v} = new LinearGradient()\ngradient${v}.colors = [${i}]\ngradient${v}.locations = [${l}]\ngradient${v}.startPoint = ${`new Point(${1-(.5+.5*Math.cos(Math.PI*(r+90)/180))}, ${1-(.5+.5*Math.sin(Math.PI*(r+90)/180))})`}\ngradient${v}.endPoint = ${`new Point(${.5+.5*Math.cos(Math.PI*(r+90)/180)}, ${.5+.5*Math.sin(Math.PI*(r+90)/180)})`}\n${a}.backgroundGradient = gradient${v}`},validate:(t,e,a)=>{let r=a;r=r.split(/,(?![^(]*\))(?![^"']*["'](?:[^"']*["'][^"']*["'])*[^"']*$)/).map(t=>t.trim());["to left","to right","to top","to bottom","to top left","to top right","to bottom left","to bottom right","to left top","to right top","to left bottom","to right bottom"].includes(r[0])?r.shift():/\d+\s*deg/.test(r[0])&&r.shift();let n=r.map(t=>/\d*(\.\d+)?%?$/.test(t)?t.match(/\d*(\.\d+)?%?$/)[0]:null).map(t=>(t&&t.endsWith("%")&&(t=Number(t.replace("%",""))/100),!isNaN(t)&&!isNaN(parseFloat(t))||"number"==typeof t?Number(t):null));n[0]||(n[0]=0),n[n.length-1]||(n[n.length-1]=1);let o=0;for(let r=0;r<n.length;r++){let i=n[r];if(i){if(o>i)throw new Error(`${t} ${e?"Attribute":"Property"} Locations Must Be In Ascending Order: ${a}`);if(i<0)throw new Error(`${t} ${e?"Attribute":"Property"} Locations Must Be Equal Or Greater Than 0: ${a}`);if(i>1)throw new Error(`${t} ${e?"Attribute":"Property"} Locations Must Be Equal Or Less Than 1: ${a}`);o=i}}}},padding:{add:(t,e,a)=>{"default"==e?k+=`\n${a}.useDefaultPadding()`:(paddingArray=e.match(/\d+/g),1==paddingArray.length?paddingArray=[paddingArray[0],paddingArray[0],paddingArray[0],paddingArray[0]]:2==paddingArray.length&&(paddingArray=[paddingArray[0],paddingArray[1],paddingArray[0],paddingArray[1]]),k+=`\n${a}.setPadding(${paddingArray.join(",")})`)},validate:(t,e,a)=>{if(!/^\s*\d+((\s*,\s*\d+){3}|(\s*,\s*\d+))?\s*$|default/g.test(a))throw new Error(`padding ${e?"Attribute":"Property"} Must Be 1, 2 Or 4 Positive Integers Separated By Commas Or default: ${a}`)}},size:{add:(t,e,a)=>{k+=`\n${a}.${t.toLowerCase().replace(/[^a-zA-Z0-9]+(.)/g,(t,e)=>e.toUpperCase())} = new Size(${e.match(/\d+/g)[0]},${e.match(/\d+/g)[1]})`},validate:(t,e,a)=>{if(!/^\s*\d+\s*,\s*\d+\s*$/.test(a))throw new Error(`${t} ${e?"Attribute":"Property"} Must Have 2 Positive Integers Separated By Commas: ${a}`)}},font:{add:(t,e,a)=>{let r=/^\s*(((black|bold|medium|light|heavy|regular|semibold|thin|ultraLight)(MonospacedSystemFont|RoundedSystemFont|SystemFont)\s*,\s*(\d+))|(body|callout|caption1|caption2|footnote|subheadline|headline|largeTitle|title1|title2|title3)|((italicSystemFont)\s*,\s*(\d+)))\s*$/;r.test(e)?k+=`\n${a}.font = Font.${e.replace(r,"$3$4$6$8($5$9)")}`:k+=`\n${a}.font = new Font("${e.split(",")[0].replace(/"/g,"")}",${e.split(",")[1].match(/\d+/g)[0]})`},validate:(t,e,a)=>{if(!/^\s*[^,]+,\s*\d+\s*$/.test(a)&&!["body","callout","caption1","caption2","footnote","subheadline","headline","italicSystemFont","largeTitle","title1","title2","title3"].includes(a))throw new Error(`font ${e?"Attribute":"Property"} Must Be 1 font And 1 Positive Integer Separated By Commas Or A Content-Based Font: ${a}`)}},point:{add:(t,e,a)=>{k+=`\n${a}.shadowOffset = new Point(${e.split(",")[0].match(/-?\d+/)[0]},${e.split(",")[1].match(/-?\d+/)[0]})`},validate:(t,e,a)=>{if(!/^\s*-?\d+\s*,\s*-?\d+\s*$/.test(a))throw new Error(`${t} ${e?"Attribute":"Property"} Must Have 2 Integers Separated By Commas: ${a}`)}},bool:{add:(t,e,a)=>{"resizable"==t&&"false"!==e&&(k+=`\n${a}.resizable = false`),"container-relative-shape"==t&&"false"!==e&&(k+=`\n${a}.containerRelativeShape = true`)},validate:()=>{}},url:{add:(t,e,a)=>{k+=`\n${a}.url = "${e.replace(/"/g,"")}"`},validate:(t,e,a)=>{if(!/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)/.test(a))throw new Error(`${t} ${e?"Attribute":"Property"} Must Be A Valid URL: ${a}`)}},image:{add:(t,e,a)=>{e.startsWith("data:image/")?k+=`\n${a}.backgroundImage = Image.fromData(Data.fromBase64String("${e.replace("data:image/png;base64,","").replace("data:image/jpeg;base64,","").replace(/"/g,"")}"))`:k+=`\n${a}.backgroundImage = await new Request("${e.replace(/"/g,"")}").loadImage()`},validate:(t,e,a)=>{}},layout:{add:(t,e,a)=>{k+=`\n${a}.layout${"vertically"==e?"Vertically":"Horizontally"}()`},validate:(t,e,a)=>{if("vertically"!=a&&"horizontally"!=a)throw new Error(`${t} ${e?"Attribute":"Property"} Must Be vertically Or horizontally: ${a}`)}},alignText:{add:(t,e,a)=>{k+=`\n${a}.${e}AlignText()`},validate:(t,e,a)=>{if(!["center","left","right"].includes(a))throw new Error(`${t} ${e?"Attribute":"Property"} Must Be left, right Or center: ${a}`)}},alignImage:{add:(t,e,a)=>{k+=`\n${a}.${e}AlignImage()`},validate:(t,e,a)=>{if(!["center","left","right"].includes(a))throw new Error(`${t} ${e?"Attribute":"Property"} Must Be left, right Or center: ${a}`)}},alignContent:{add:(t,e,a)=>{k+=`\n${a}.${e}AlignContent()`},validate:(t,e,a)=>{if(!["center","top","bottom"].includes(a))throw new Error(`${t} ${e?"Attribute":"Property"} Must Be top, bottom Or center: ${a}`)}},applyStyle:{add:(t,e,a)=>{k+=`\n${a}.apply${e[0].toUpperCase()+e.slice(1)}Style()`},validate:(t,e,a)=>{if(!["date","timer","offset","relative","time"].includes(a))throw new Error(`${t} ${e?"Attribute":"Property"} Must Be date, timer , relative, time, Or offset: ${a}`)}},contentMode:{add:(t,e,a)=>{k+=`\n${a}.apply${e[0].toUpperCase()+e.slice(1)}ContentMode()`},validate:(t,e,a)=>{if(!["filling","fitting"].includes(a))throw new Error(`${t} ${e?"Attribute":"Property"} Must Be filling Or fitting: ${a}`)}}};let n=["img","spacer"];for(let t of Object.keys(a))"object"==typeof a[t]&&(a[t].isSelfClosing&&n.push(t),a[t]=a[t].func);const o=/^<([-A-Za-z0-9_]+)((?:\s+[a-zA-Z_:][-a-zA-Z0-9_:.]*(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)>/,i=/^<\/([-A-Za-z0-9_]+)[^>]*>/,l=/([a-zA-Z_:][-a-zA-Z0-9_:.]*)(?:\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))?/g;function s(t){return t.split(",").reduce((t,e)=>(t[e]=!0,t),{})}const c=s(n.join(",")),d=s("no-css,children");function u(t){return!!c[t]}class g{constructor(t,e){this.name=t,this.attributes=this.getAttributes(e)}getAttributes(t){let e={};return t.replace(l,function(t,a){const r=Array.prototype.slice.call(arguments),n=r[2]?r[2]:r[3]?r[3]:r[4]?r[4]:function(t){return!!d[t]}(a)?a:"";e[a]=n.replace(/(^|[^\\])"/g,'$1\\"')}),e}}class f extends g{constructor(t,e){super(t,e)}}class p{constructor(t){this.name=t}}class h{constructor(t){this.text=t}}const m="Element",$="Text";function w(t,e){switch(t){case m:return function(t){const e=t.name,a=t.attributes;return t instanceof f?{type:m,tagName:e,attributes:a}:{type:m,tagName:e,attributes:a,children:[]}}(e);case $:return function(t){const e=t.text;return{type:$,content:e}}(e)}}function b(t){return function(t){let e={tag:"root",children:[]},a=[e];a.last=(()=>a[a.length-1]);for(let e=0;e<t.length;e++){const r=t[e];if(r instanceof g){const t=w(m,r);t.children?a.push(t):a.last().children.push(t)}else if(r instanceof p){let t=a[a.length-2],e=a.pop();t.children.push(e)}else r instanceof h?a.last().children.push(w($,r)):"Comment"!=r.type||a.last().children.push(r)}return e}(function(t){let e=t,a=[];const r=Date.now()+1e3;for(;e;){if(0===e.indexOf("\x3c!--")){const t=e.indexOf("--\x3e")+3;a.push({type:"Comment",text:e.substring(4,t-3)}),e=e.substring(t);continue}if(0===e.indexOf("</")){const t=e.match(i);if(!t)continue;e=e.substring(t[0].length);const r=t[1];if(u(r))continue;a.push(new p(r));continue}if(0===e.indexOf("<")){const t=e.match(o);if(!t)continue;e=e.substring(t[0].length);const r=t[1],n=t[2],i=u(r)?new f(r,n):new g(r,n);a.push(i);continue}const t=e.indexOf("<"),n=t<0?e:e.substring(0,t);if(e=t<0?"":e.substring(t),a.push(new h(n)),Date.now()>=r)break}return a}(t))}let y,k="",A={},v=-1,I=b(t).children.filter(t=>{if("widget"==t.tagName)return t})[0];if(!I)throw new Error("widget Tag Must Be The Root Tag");let x=I.children.filter(t=>"style"==t.tagName),N="";for(let t of x)for(let e of t.children)"Text"==e.type&&(N+="\n"+e.content.trim());let O=[],j=N.match(/[\s\S]+?{[\s\S]*?}/g)||[];for(let t=0;t<j.length;t++){let e=j[t];if(!/^\s*(\.?[\w\-]+?|\*)\s*\{(\s*[\w\-]+\s*:\s*[^\n]+?\s*;)*?\s*([\w\-]+\s*:\s*[^\n]+\s*;?)?\s*\}/.test(e))throw new Error(`Invalid CSS Rule:\n${e.trim()}`);let a=e.match(/\.?[\w\-]+|\*/)[0];O[t]={selector:a,css:{}},e.match(/\{([\s\S]*)\}/)[1].split(";").map(t=>t.trim()).filter(t=>t).forEach(e=>{O[t].css[e.split(/:/)[0].trim()]=e.substring(e.indexOf(":")+1).trim()})}await async function t(e){if("Text"==e.type||"style"==e.tagName)return;if("widget"==e.tagName&&k)throw new Error("widget Tag Must Not Be Nestled");A[e.tagName]||0==A[e.tagName]?A[e.tagName]++:A[e.tagName]=0;let n=A[e.tagName];let o=[];e.children=e.children||[];for(let t of e.children)"Text"==t.type&&o.push(t.content.trim());let i=o.join(" ").replace(/&lt;/g,"<").replace(/&gt/g,">").replace(/&amp;/g,"&").replace(/\n\s+/g,"\\n");let l=["*",e.tagName];let s={};for(let t of Object.keys(e.attributes)){let a=e.attributes[t].trim();if("class"==t){a=a.trim().split(" ");for(let t of a)l.push("."+t)}else s[t]=a}let c={};for(let t of O)if(l.includes(t.selector)&&!Object.keys(e.attributes).includes("no-css"))for(let e of Object.keys(t.css))delete c[e],c[e]=t.css[e];for(let t of Object.keys(s))delete c[t],c[t]=s[t];let d;switch(e.tagName){case"spacer":return k+=`\nlet spacer${n} = ${y}.addSpacer(${s.space&&"null"!==s.space?s.space:""})`,void P(s,c,d={space:"posInt"});case"widget":k+="let widget = new ListWidget()",P(s,c,d={background:["gradient","image","colour"],"refresh-after-date":"posInt",spacing:"posInt",url:"url",padding:"padding"});for(let t of Object.keys(c)){let e=c[t],a="widget";if("background"==t&&"null"!==e&&"no-css"!=t&&"children"!=t)try{r.url.validate("background",!0,e),r.image.add(t,e,a)}catch(t){1===e.split(/,(?![^(]*\))(?![^"']*["'](?:[^"']*["'][^"']*["'])*[^"']*$)/).length?await r.colour.add("background-color",e,a):await r.gradient.add("background-gradient",e,a)}else"null"!=e&&"children"!=t&&"no-css"!=t&&await r[d[t]].add(t,e,a)}for(let a of e.children)y="widget",await t(a);return;case"stack":k+=`\nlet stack${n} = ${y}.addStack()`,P(s,c,d={background:["gradient","image","colour"],spacing:"posInt",url:"url",padding:"padding","border-color":"colour","border-width":"posInt",size:"size","corner-radius":"posInt","align-content":"alignContent",layout:"layout"});for(let t of Object.keys(c)){let e=c[t],a="stack"+n;if("background"==t&&"null"!==e&&"children"!=t&&"no-css"!=t)try{r.url.validate("background",!0,e),r.image.add(t,e,a)}catch(t){1===e.split(/,(?![^(]*\))(?![^"']*["'](?:[^"']*["'][^"']*["'])*[^"']*$)/).length?await r.colour.add("background-color",e,a):await r.gradient.add("background-gradient",e,a)}else"null"!=e&&"children"!=t&&"no-css"!=t&&await r[d[t]].add(t,e,a)}let o=n;for(let a of e.children)y="stack"+o,await t(a);return;case"img":let l;if(!s.src||"null"==s.src)throw new Error("img Element Must Have A src Attribute");l=s.src.startsWith("data:image/")?`Image.fromData(Data.fromBase64String("${s.src.replace("data:image/png;base64,","").replace("data:image/jpeg;base64,","").replace(/"/g,"")}"))`:`await new Request("${s.src.replace(/"/g,"")}").loadImage()`,k+=`\nlet img${n} = ${y}.addImage(${l})`,P(s,c,d={src:"image",url:"url","border-color":"colour","border-width":"posInt","corner-radius":"posInt","image-size":"size","image-opacity":"decimal","tint-color":"colour",resizable:"bool","container-relative-shape":"bool","content-mode":"contentMode","align-image":"alignImage"});for(let t of Object.keys(c)){if("src"==t)continue;let e=c[t],a="img"+n;"null"!=e&&"children"!=t&&"no-css"!=t&&await r[d[t]].add(t,e,a)}return;case"text":k+=`\nlet text${n} = ${y}.addText("${i.replace(/"/g,"")}")`,P(s,c,d={url:"url",font:"font","line-limit":"posInt","minimum-scale-factor":"decimal","shadow-color":"colour","shadow-offset":"point","shadow-radius":"posInt","text-color":"colour","text-opacity":"decimal","align-text":"alignText"});for(let t of Object.keys(c)){let e=c[t],a="text"+n;"null"!=e&&"children"!=t&&"no-css"!=t&&await r[d[t]].add(t,e,a)}return;case"date":k+=`\nlet date${n} = ${y}.addDate(new Date("${i.replace(/"/g,"")}"))`,P(s,c,d={url:"url",font:"font","line-limit":"posInt","minimum-scale-factor":"decimal","shadow-color":"colour","shadow-offset":"point","shadow-radius":"posInt","text-color":"colour","text-opacity":"decimal","align-text":"alignText","apply-style":"applyStyle"});for(let t of Object.keys(c)){let e=c[t],a="date"+n;"null"!=e&&"children"!=t&&"no-css"!=t&&await r[d[t]].add(t,e,a)}return;default:if(!Object.keys(a).includes(e.tagName))throw new Error("Invalid Tag Name: "+e.tagName);return k+=`\n// <${e.tagName}>`,await a[e.tagName](P,async function(a){let r=b(a);r.children=r.children.map(t=>(function t(e,a){if(e.attributes&&Object.keys(e.attributes).includes("children"))for(let t of a)e.children.push(t);e.children&&e.children.map(e=>{t(e,a)});e.attributes&&(e.attributes["no-css"]="");return e})(t,e.children));for(let e of r.children){await t(e)}},S,c,s,i),void(k+=`\n// </${e.tagName}>`)}if("Comment"==e.type)return void(e.text.match(/\n/g)?k+=`\n/*\n${e.text}\n*/`:k+=`\n// ${e.text}`)}(I),1==e&&console.log(k);let M=new(0,Object.getPrototypeOf(async function(){}).constructor)(k+"\nreturn widget");return await M();async function E(t){if(t.type=="Text"||t.tagName=="style"){return}if(t.tagName=="widget"&&k){throw new Error("widget Tag Must Not Be Nestled")}if(A[t.tagName]||A[t.tagName]==0){A[t.tagName]++}else{A[t.tagName]=0}let e=A[t.tagName];let n=[];t.children=t.children||[];for(let e of t.children){if(e.type=="Text"){n.push(e.content.trim())}}let o=n.join(" ").replace(/&lt;/g,"<").replace(/&gt/g,">").replace(/&amp;/g,"&").replace(/\n\s+/g,"\\n");let i=["*",t["tagName"]];let l={};for(let e of Object.keys(t.attributes)){let a=t.attributes[e].trim();if(e=="class"){a=a.trim().split(" ");for(let t of a){i.push("."+t)}}else{l[e]=a}}let s={};for(let e of O){if(i.includes(e.selector)&&!Object.keys(t.attributes).includes("no-css")){for(let t of Object.keys(e.css)){delete s[t];s[t]=e.css[t]}}}for(let t of Object.keys(l)){delete s[t];s[t]=l[t]}let c;switch(t.tagName){case"spacer":k+=`\nlet spacer${e} = ${y}.addSpacer(${l.space&&l.space!=="null"?l.space:""})`;c={space:"posInt"};P(l,s,c);return;break;case"widget":k+=`let widget = new ListWidget()`;c={background:["gradient","image","colour"],"refresh-after-date":"posInt",spacing:"posInt",url:"url",padding:"padding"};P(l,s,c);for(let t of Object.keys(s)){let e=s[t];let a="widget";if(t=="background"&&e!=="null"&&t!="no-css"&&t!="children"){try{r.url.validate("background",true,e);r.image.add(t,e,a)}catch(t){if(e.split(/,(?![^(]*\))(?![^"']*["'](?:[^"']*["'][^"']*["'])*[^"']*$)/).length===1){await r.colour.add("background-color",e,a)}else{await r.gradient.add("background-gradient",e,a)}}}else if(e!="null"&&t!="children"&&t!="no-css"){await r[c[t]].add(t,e,a)}}for(let e of t["children"]){y="widget";await E(e)}return;break;case"stack":k+=`\nlet stack${e} = ${y}.addStack()`;c={background:["gradient","image","colour"],spacing:"posInt",url:"url",padding:"padding","border-color":"colour","border-width":"posInt",size:"size","corner-radius":"posInt","align-content":"alignContent",layout:"layout"};P(l,s,c);for(let t of Object.keys(s)){let a=s[t];let n="stack"+e;if(t=="background"&&a!=="null"&&t!="children"&&t!="no-css"){try{r.url.validate("background",true,a);r.image.add(t,a,n)}catch(t){if(a.split(/,(?![^(]*\))(?![^"']*["'](?:[^"']*["'][^"']*["'])*[^"']*$)/).length===1){await r.colour.add("background-color",a,n)}else{await r.gradient.add("background-gradient",a,n)}}}else if(a!="null"&&t!="children"&&t!="no-css"){await r[c[t]].add(t,a,n)}}let n=e;for(let e of t["children"]){y="stack"+n;await E(e)}return;break;case"img":let i;if(!l["src"]||l["src"]=="null"){throw new Error("img Element Must Have A src Attribute")}if(l["src"].startsWith("data:image/")){i=`Image.fromData(Data.fromBase64String("${l["src"].replace("data:image/png;base64,","").replace("data:image/jpeg;base64,","").replace(/"/g,"")}"))`}else{i=`await new Request("${l["src"].replace(/"/g,"")}").loadImage()`}k+=`\nlet img${e} = ${y}.addImage(${i})`;c={src:"image",url:"url","border-color":"colour","border-width":"posInt","corner-radius":"posInt","image-size":"size","image-opacity":"decimal","tint-color":"colour",resizable:"bool","container-relative-shape":"bool","content-mode":"contentMode","align-image":"alignImage"};P(l,s,c);for(let t of Object.keys(s)){if(t=="src"){continue}let a=s[t];let n="img"+e;if(a!="null"&&t!="children"&&t!="no-css"){await r[c[t]].add(t,a,n)}}return;break;case"text":k+=`\nlet text${e} = ${y}.addText("${o.replace(/"/g,"")}")`;c={url:"url",font:"font","line-limit":"posInt","minimum-scale-factor":"decimal","shadow-color":"colour","shadow-offset":"point","shadow-radius":"posInt","text-color":"colour","text-opacity":"decimal","align-text":"alignText"};P(l,s,c);for(let t of Object.keys(s)){let a=s[t];let n="text"+e;if(a!="null"&&t!="children"&&t!="no-css"){await r[c[t]].add(t,a,n)}}return;break;case"date":k+=`\nlet date${e} = ${y}.addDate(new Date("${o.replace(/"/g,"")}"))`;c={url:"url",font:"font","line-limit":"posInt","minimum-scale-factor":"decimal","shadow-color":"colour","shadow-offset":"point","shadow-radius":"posInt","text-color":"colour","text-opacity":"decimal","align-text":"alignText","apply-style":"applyStyle"};P(l,s,c);for(let t of Object.keys(s)){let a=s[t];let n="date"+e;if(a!="null"&&t!="children"&&t!="no-css"){await r[c[t]].add(t,a,n)}}return;break;default:if(!Object.keys(a).includes(t["tagName"])){throw new Error("Invalid Tag Name: "+t["tagName"])}k+=`\n// <${t.tagName}>`;await a[t["tagName"]](P,d,S,s,l,o);k+=`\n// </${t.tagName}>`;return;async function d(e){let a=b(e);a.children=a.children.map(e=>n(e,t.children));let r=y;for(let t of a.children){let e=r;await E(t)}function n(t,e){if(t.attributes&&Object.keys(t.attributes).includes("children")){for(let a of e){t.children.push(a)}}if(t.children){t.children.map(t=>{n(t,e)})}if(t.attributes){t.attributes["no-css"]=""}return t}}}if(t["type"]=="Comment"){if(!t["text"].match(/\n/g)){k+=`\n// ${t["text"]}`}else{k+=`\n/*\n${t["text"]}\n*/`}return}}function P(t,e,a){for(let e of Object.keys(t))if("null"!=t[e]&&"children"!=e&&"no-css"!=e){if(!a[e])throw new Error(`Unknown Attribute: ${e}`);if("string"==typeof a[e])r[a[e]].validate(e,!0,t[e]);else{let n=!1;for(let o of a[e])try{r[o].validate(e,!0,t[e]),n=!0}catch(t){}if(!1===n)throw new Error(`${e} Attribute Must Be A ${a[e].join(", ").replace(/,([^,]*?)$/," or$1")} Type: ${t[e]}`)}}for(let t of Object.keys(e))if("null"!=e[t]&&"children"!=t&&"no-css"!=t){if(!a[t])throw new Error(`Unknown Property: ${t}`);if("string"==typeof a[t])r[a[t]].validate(t,!1,e[t]);else{let n=!1;for(let o of a[t])try{r[o].validate(t,!1,e[t]),n=!0}catch(t){}if(!1===n)throw new Error(`${attr} Property Must Be A ${a[t].join(", ").replace(/,([^,]*?)$/," or$1")} Type: ${e[t]}`)}}}function S(t,e){for(let a of Object.keys(e))Object.keys(t).includes(a)||(t[a]="null");return t}async function z(t){let e=new WebView;return await e.loadHTML(`<div id="div"style="color:${t}"></div>`),function(t,e,a,r){t=t.toString(16),e=e.toString(16),a=a.toString(16),1==t.length&&(t="0"+t);1==e.length&&(e="0"+e);1==a.length&&(a="0"+a);r=r?1==r.length?",0"+r:","+r:"";return`new Color("${"#"+t+e+a}"${r})`}(...(await e.evaluateJavaScript('window.getComputedStyle(document.getElementById("div")).color')).match(/\d+(\.\d+)?/g).map(t=>Number(t)))}}
